import{r as v,e as E,j as a,f as x}from"./index-DwKbRvpM.js";import{u as j,a as w,I as t}from"./Input-BR3tDxs1.js";import{H as A,R as k,C as S,F as C,B as F}from"./Heading-C5kbgIhg.js";import"./Button-DJc1Gurw.js";const N=()=>{const[n,e]=v.useState("idle"),[r,l]=v.useState(null);return{emailAvailabilityStatus:n,checkEmailAvailability:async o=>{l(o),e("checking");try{(await E.get(`/users?email=${o}`)).data.length?e("notAvailable"):e("available")}catch(m){e("failed"),console.log(m)}},resetCheckEmailAvailability:()=>{e("idle"),l(null)},prevEnteredEmail:r}},T=()=>{const{checkEmailAvailability:n,emailAvailabilityStatus:e,prevEnteredEmail:r,resetCheckEmailAvailability:l}=N(),{register:s,handleSubmit:d,trigger:o,getFieldState:m,formState:{errors:i,isValid:f,isSubmitting:u}}=j({mode:"onBlur",shouldFocusError:!0,resolver:w(x)}),y=c=>console.log(c),p=async c=>{await o("email");const b=c.target.value,{isDirty:g,invalid:h}=m("email");g&&!h&&b!==r&&n(b),g&&h&&r&&l()};return a.jsxs("section",{children:[a.jsx(A,{title:"User Registration"}),a.jsx(k,{className:"my-2",children:a.jsx(S,{md:{span:6,offset:3},children:a.jsxs(C,{onSubmit:d(y),children:[a.jsx(t,{label:"First Name",name:"firstName",register:s,error:i.firstName?.message||"",autoFocus:!0}),a.jsx(t,{label:"Last Name",name:"lastName",register:s,error:i.lastName?.message||""}),a.jsx(t,{label:"Email Address",name:"email",register:s,onBlur:p,error:i.email?.message?i.email?.message:e==="notAvailable"?"This email is already in use.":e==="failed"?"Error from the server.":"",formText:e==="checking"?"We're currently checking the availability of this email address. Please wait a moment.":"",success:e==="available"?"This email is available for use.":"",disabled:e==="checking"}),a.jsx(t,{label:"Password",name:"password",type:"password",register:s,error:i.password?.message||""}),a.jsx(t,{label:"Confirm Password",name:"confirmPassword",type:"password",register:s,error:i.confirmPassword?.message||""}),a.jsx(F,{disabled:!f||u,variant:"info",type:"submit",style:{color:"white"},children:u?"Registering...":"Register"})]})})})]})};export{T as default};
