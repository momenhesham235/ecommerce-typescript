import{r as h,s as S,b as w,d as N,e as k,n as R,t as C,v as F,g as P,j as e}from"./index-BP77i2Bk.js";import{u as H,a as B,I as c,A as O}from"./Input-BnC4mHtu.js";import{H as T}from"./Heading-B4wgSNhp.js";import{R as I,C as D}from"./Row-gmytxdi1.js";import{F as L,S as U}from"./Spinner-BBW5ju7R.js";import{B as V}from"./Button-DoyuUPbG.js";import"./hook-CnfcvmXm.js";import"./useEventCallback-DxQmx_i4.js";import"./CloseButton-Bswu-Ih9.js";import"./Anchor-B9Cte2h4.js";import"./warning-xdCFWgwQ.js";const $=()=>{const[a,i]=h.useState("idle"),[s,l]=h.useState(null);return{emailAvailabilityStatus:a,checkEmailAvailability:async t=>{l(t),i("checking");try{(await S.get(`/users?email=${t}`)).data.length?i("notAvailable"):i("available")}catch(r){i("failed"),console.log(r)}},resetCheckEmailAvailability:()=>{i("idle"),l(null)},prevEnteredEmail:s}},z=()=>{const a=w(),i=N(),{loading:s,error:l}=k(m=>m.auth),{checkEmailAvailability:o,emailAvailabilityStatus:n,prevEnteredEmail:t,resetCheckEmailAvailability:r}=$(),{register:p,handleSubmit:b,trigger:f,getFieldState:v,formState:{errors:y,isValid:E}}=H({mode:"onChange",shouldFocusError:!0,resolver:B(C)}),x=async m=>{const{firstName:d,lastName:u,email:g,password:j}=m;a(F({firstName:d,lastName:u,email:g,password:j})).unwrap().then(()=>i(`${P.LOGIN}?msg=registration_successful`))},A=async m=>{await f("email");const d=m.target.value,{isDirty:u,invalid:g}=v("email");u&&!g&&d!==t&&o(d),u&&g&&t&&r()};return h.useEffect(()=>()=>{a(R())},[a]),{loading:s,error:l,emailAvailabilityStatus:n,formErrors:y,isValid:E,register:p,handleSubmit:b,submitHandler:x,emailOnBlurHandler:A}},ee=()=>{const{register:a,handleSubmit:i,formErrors:s,isValid:l,loading:o,error:n,submitHandler:t,emailAvailabilityStatus:r,emailOnBlurHandler:p}=z();return e.jsxs("section",{children:[e.jsx(T,{title:"User Registration"}),e.jsx(I,{className:"my-2",children:e.jsx(D,{md:{span:6,offset:3},children:e.jsxs(L,{onSubmit:i(t),children:[e.jsx(c,{label:"First Name",name:"firstName",register:a,error:s.firstName?.message||"",autoFocus:!0}),e.jsx(c,{label:"Last Name",name:"lastName",register:a,error:s.lastName?.message||""}),e.jsx(c,{label:"Email Address",name:"email",register:a,onBlur:p,error:s.email?.message?s.email?.message:r==="notAvailable"?"This email is already in use.":r==="failed"?"Error from the server.":"",formText:r==="checking"?"We're currently checking the availability of this email address. Please wait a moment.":"",success:r==="available"?"This email is available for use.":"",disabled:r==="checking"}),e.jsx(c,{label:"Password",name:"password",type:"password",register:a,error:s.password?.message||""}),e.jsx(c,{label:"Confirm Password",name:"confirmPassword",type:"password",register:a,error:s.confirmPassword?.message||""}),e.jsx(V,{disabled:!l||o==="pending",variant:"info",type:"submit",style:{color:"white"},children:o==="pending"?e.jsxs(e.Fragment,{children:[e.jsx(U,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),e.jsx("span",{className:"ms-2",children:"Registering..."})]}):"Register"}),n&&e.jsxs(O,{variant:"danger mt-2",children:[" ",n," "]})]})})})]})};export{ee as default};
