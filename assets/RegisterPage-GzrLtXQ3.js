import{r as p,v as S,b as w,f as N,e as k,o as R,w as C,x as F,h as P,j as e}from"./index-EH4w_4Ej.js";import{u as H,a as B,I as c,A as O}from"./Input-CqrSn9ZE.js";import{H as T}from"./Heading-I2qKyJvb.js";import{R as I,C as D}from"./Row-DV6HXUw5.js";import{F as L,S as U}from"./Spinner-Ch8TXIx6.js";import{B as V}from"./Button-WzEuFqyK.js";import"./hook-DrdLScyh.js";import"./useEventCallback-BSKAD5dq.js";import"./CloseButton-B9LnBeMb.js";import"./Anchor-CYV8TN4P.js";import"./warning-Cn0fKLcI.js";const $=()=>{const[a,i]=p.useState("idle"),[s,l]=p.useState(null);return{emailAvailabilityStatus:a,checkEmailAvailability:async t=>{l(t),i("checking");try{(await S.get(`/users?email=${t}`)).data.length?i("notAvailable"):i("available")}catch(r){i("failed"),console.log(r)}},resetCheckEmailAvailability:()=>{i("idle"),l(null)},prevEnteredEmail:s}},z=()=>{const a=w(),i=N(),{loading:s,error:l}=k(m=>m.auth),{checkEmailAvailability:o,emailAvailabilityStatus:n,prevEnteredEmail:t,resetCheckEmailAvailability:r}=$(),{register:h,handleSubmit:f,trigger:b,getFieldState:v,formState:{errors:y,isValid:E}}=H({mode:"onChange",shouldFocusError:!0,resolver:B(C)}),x=async m=>{const{firstName:d,lastName:u,email:g,password:j}=m;a(F({firstName:d,lastName:u,email:g,password:j})).unwrap().then(()=>i(`${P.LOGIN}?msg=registration_successful`))},A=async m=>{await b("email");const d=m.target.value,{isDirty:u,invalid:g}=v("email");u&&!g&&d!==t&&o(d),u&&g&&t&&r()};return p.useEffect(()=>()=>{a(R())},[a]),{loading:s,error:l,emailAvailabilityStatus:n,formErrors:y,isValid:E,register:h,handleSubmit:f,submitHandler:x,emailOnBlurHandler:A}},ee=()=>{const{register:a,handleSubmit:i,formErrors:s,isValid:l,loading:o,error:n,submitHandler:t,emailAvailabilityStatus:r,emailOnBlurHandler:h}=z();return e.jsxs("section",{children:[e.jsx(T,{title:"User Registration"}),e.jsx(I,{className:"my-2",children:e.jsx(D,{md:{span:6,offset:3},children:e.jsxs(L,{onSubmit:i(t),children:[e.jsx(c,{label:"First Name",name:"firstName",register:a,error:s.firstName?.message||"",autoFocus:!0}),e.jsx(c,{label:"Last Name",name:"lastName",register:a,error:s.lastName?.message||""}),e.jsx(c,{label:"Email Address",name:"email",register:a,onBlur:h,error:s.email?.message?s.email?.message:r==="notAvailable"?"This email is already in use.":r==="failed"?"Error from the server.":"",formText:r==="checking"?"We're currently checking the availability of this email address. Please wait a moment.":"",success:r==="available"?"This email is available for use.":"",disabled:r==="checking"}),e.jsx(c,{label:"Password",name:"password",type:"password",register:a,error:s.password?.message||""}),e.jsx(c,{label:"Confirm Password",name:"confirmPassword",type:"password",register:a,error:s.confirmPassword?.message||""}),e.jsx(V,{disabled:!l||o==="pending",variant:"info",type:"submit",style:{color:"white"},children:o==="pending"?e.jsxs(e.Fragment,{children:[e.jsx(U,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),e.jsx("span",{className:"ms-2",children:"Registering..."})]}):"Register"}),n&&e.jsxs(O,{variant:"danger mt-2",children:[" ",n," "]})]})})})]})};export{ee as default};
