import{j as e,b as f,e as y,r as p,E as S,F as b,G as F,H,I,J as O,K as w,M as g,L as E,g as P}from"./index-Jqg1otTD.js";import{C as v,u as A,L}from"./CartItem-DhTftWqV.js";import{S as k,H as G}from"./Heading-B20WNSnQ.js";import{i as l}from"./Modal-BP3DMXiN.js";import{a as h}from"./warning-Dzgz_eEz.js";import"./CloseButton-B6wDIWZm.js";const M=({products:t,onChangeQuantity:n,onRemoveItem:o})=>{const r=t.map(a=>e.jsx(v,{...a,onChangeQuantity:n,onRemoveItem:o},a.id));return e.jsx(e.Fragment,{children:r})},q="_container_ptx4s_1",C={container:q},N=({products:t})=>{const n=f(),{requireAuth:o}=A(),{loading:r,error:a}=y(u=>u.orders),[c,d]=p.useState(!1),i=t.reduce((u,m)=>m.quantity&&typeof m.quantity=="number"?u+m.price*m.quantity:u,0),x=()=>{o(()=>{d(!0)})},s=()=>{d(!1)},j=()=>{n(S(i)).unwrap().then(()=>{n(b()),s()})};return e.jsxs(e.Fragment,{children:[e.jsxs(l,{show:c,onHide:s,backdrop:"static",children:[e.jsx(l.Header,{closeButton:!0,children:e.jsx(l.Title,{children:"Placing Order"})}),e.jsxs(l.Body,{children:["Are you sure you want to place order with Subtotal:",i.toFixed(2)," EGP",!r&&a&&e.jsx("p",{style:{color:"#DC3545",marginTop:"10px"},children:a})]}),e.jsxs(l.Footer,{children:[e.jsx(h,{variant:"secondary",onClick:s,children:"Close"}),e.jsx(h,{variant:"info",style:{color:"white"},onClick:j,disabled:r==="pending",children:r==="pending"?e.jsxs(e.Fragment,{children:[e.jsx(k,{animation:"border",size:"sm"})," Loading..."]}):"Confirm"})]})]}),e.jsxs("section",{className:C.container,children:[e.jsx("span",{children:"Subtotal:"}),e.jsxs("span",{children:[" ",i.toFixed(2)," EGP"]})]}),e.jsxs("section",{className:C.container,children:[e.jsx("span",{}),e.jsx("span",{children:e.jsx(h,{variant:"primary",style:{color:"white"},onClick:x,children:"Place Order"})})]})]})},R=()=>{const t=f(),{items:n,productsFullInfo:o,loading:r,error:a}=y(s=>s.cart),c=y(s=>s.orders.loading),d=o.map(s=>({...s,quantity:n[s.id]})),i=p.useCallback((s,j)=>{t(F({id:s,quantity:j}))},[t]),x=p.useCallback(s=>{t(H(s))},[t]);return p.useEffect(()=>{const s=t(I());return()=>{s.abort(),t(O()),t(w())}},[t]),{products:d,loading:r,error:a,placeOrderStatus:c,changeQuantityHandler:i,removeItemHandler:x}},Y=()=>{const{products:t,loading:n,error:o,placeOrderStatus:r,changeQuantityHandler:a,removeItemHandler:c}=R();return e.jsxs(e.Fragment,{children:[e.jsx(G,{title:"Your Cart"}),e.jsx(L,{loading:n,error:o,type:"cart",children:t.length?e.jsxs(e.Fragment,{children:[e.jsx(M,{products:t,onChangeQuantity:a,onRemoveItem:c}),e.jsx(N,{products:t})]}):r==="succeeded"?e.jsx(g,{type:"success",message:"Order Placed Successfully!"}):e.jsxs(e.Fragment,{children:[e.jsx(g,{type:"empty",message:"Your cart is empty"}),e.jsx(E,{to:P.CATEGORIES,className:"d-flex justify-content-center",children:e.jsx(h,{variant:"primary",className:"my-2",children:"Shop Now"})})]})})]})};export{Y as default};
